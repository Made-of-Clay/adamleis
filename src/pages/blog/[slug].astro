---
import SiteShell from '@/components/SiteShell.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
    const allBlogs = await getCollection('blog');
    const data = allBlogs
        .filter(post => !post.slug.includes('/'))
        .map(post => ({
            params: {
                slug: post.slug.split('/')[0],
            },
            props: { post },
        }));
    return data;
}

const { post } = Astro.props;

const { Content } = await post.render();
---

<SiteShell>
    <article data-tpl="[slug]">
        <Content />
    </article>
</SiteShell>