import{G as E,S as G,A as W,P as V,B as D,F as O,a as K,b as R,c as T,d as I,D as q,e as j,C as U,f as N,g as Y,h as $,M as S,V as u,i as X,j as _,k as Z,m as Q,l as J,L as ee,E as te,n as ie,O as ne,W as oe,o as se,p as ae,q as re,r as ce,s as de}from"./vendor-DBGZ9kqf.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(t){if(t.ep)return;t.ep=!0;const o=n(t);fetch(t.href,o)}})();let v;function C(){return v||(v=new E({title:"üêû Debug GUI",width:300})),v}let L;function k(){return L||(L=new G),L}function le(){const s=document.createElement("canvas");s.width=32,s.height=32;const e=s.getContext("2d");if(!e)return null;const n=e.createRadialGradient(16,16,0,16,16,16);return n.addColorStop(0,"rgba(255, 255, 255, 1)"),n.addColorStop(.4,"rgba(255, 255, 255, 0.2)"),n.addColorStop(1,"rgba(0, 0, 0, 0)"),e.fillStyle=n,e.fillRect(0,0,32,32),new U(s)}function pe(){const e=C().addFolder("Lights"),n=new W("white",.25);e.add(n,"visible").name("Ambient Light");const i=new V("#ffb172",20,100);i.position.set(-18,2.5,5.3),i.castShadow=!0,i.shadow.radius=4,i.shadow.camera.near=.1,i.shadow.camera.far=1e3,i.shadow.mapSize.width=2048,i.shadow.mapSize.height=2048,e.add(i,"visible").name("Fireplace Point Light"),e.add(i.position,"x").min(-30).max(30).step(.01).name("Point Light Position X"),e.add(i.position,"y").min(-30).max(30).step(.01).name("Point Light Position Y"),e.add(i.position,"z").min(-30).max(30).step(.01).name("Point Light Position Z");const t=25,o=new D,a=new Float32Array(t*3),p=new Float32Array(t),d=new Float32Array(t);for(let c=0;c<t;c++){const g=(Math.random()-.5)*.85,m=Math.random()*.8,H=(Math.random()-.5)*.85;a[c*3]=g,a[c*3+1]=m,a[c*3+2]=H,p[c]=.5+Math.random()*1,d[c]=m}o.setAttribute("position",new O(a,3));const w=le(),l=new K(o,new R({color:"#ff6600",size:.5,transparent:!0,opacity:.8,map:w||void 0,blending:T,depthWrite:!1}));l.position.copy(i.position);const h=new I(i,.25,"orange");h.visible=!1,e.add(h,"visible").name("Fireplace Point Light Helper");const r=new q("#dce6f7",3);e.add(r,"intensity").min(0).max(100).step(.01).name("Directional Light Intensity"),r.position.set(0,10,30),r.castShadow=!0,r.shadow.radius=4,r.shadow.camera.near=.1,r.shadow.camera.far=1e3,r.shadow.mapSize.width=2048,r.shadow.mapSize.height=2048;const f=new j(r);return e.add(f,"visible").name("Directional Light Helper"),k().add(n,i,h,r,f,l),c=>{const g=o.attributes.position.array;for(let m=0;m<t;m++)g[m*3+1]+=p[m]*c,m===0&&(i.intensity=20+(Math.random()-.5)*5),g[m*3+1]>1.2&&(g[m*3+1]=0,g[m*3]=(Math.random()-.5)*.5,g[m*3+2]=(Math.random()-.5)*.5);o.attributes.position.needsUpdate=!0}}function he(){const s=k(),n=C().addFolder("Helpers"),i=new N(4);i.visible=!1,s.add(i),n.add(i,"visible").name("Axes");const t=new Y(20,20,"teal","darkgray");t.position.y=-.01,s.add(t),n.add(t,"visible").name("Grid")}try{S.prototype.raycast=$}catch{}class me{root;mesh;collider;velocity=new u;playerSpeed=10;physicsSteps=5;tempVector=new u;tempVector2=new u;tempBox=new X;constructor(e){this.root=e;const n=new _(.35,1.5,4,8),i=new Z({color:65280,wireframe:!0,visible:!1});this.collider=new S(n,i),this.collider.geometry.translate(0,.75+.35,0),this.collider.position.set(0,3,0)}initBVH(){const e=[];if(this.root.updateMatrixWorld(!0),this.root.traverse(i=>{const t=i;if(t.isMesh){if(t===this.collider)return;const o=t.geometry.clone();o.applyMatrix4(t.matrixWorld);for(const a in o.attributes)a!=="position"&&a!=="index"&&o.deleteAttribute(a);e.push(o)}}),e.length===0){console.warn("Antigravity Agent: no meshes found to build BVH from");return}const n=Q(e);if(!n){console.warn("Antigravity Agent: failed to merge geometries");return}n.boundsTree=new J(n,{lazyGeneration:!1}),this.mesh=new S(n)}update(e,n){if(!this.mesh)return;const i=this.collider,t=this.mesh;this.velocity.x=n.x*this.playerSpeed,this.velocity.z=n.z*this.playerSpeed,this.velocity.y=0,i.position.addScaledVector(this.velocity,e),this.updateCollision(t)}getColliderEnds(e,n,i){n.set(0,-1.5/2,0),i.set(0,1.5/2,0),n.applyMatrix4(e.matrixWorld),i.applyMatrix4(e.matrixWorld)}updateCollision(e){const n=e.geometry.boundsTree;if(!n)return;const i=this.collider,t=.35,o=this.physicsSteps;for(let a=0;a<o;a++)this.tempBox.makeEmpty(),this.tempBox.expandByObject(i),this.tempBox.min.addScalar(-.1),this.tempBox.max.addScalar(.1),n.shapecast({intersectsBounds:p=>p.intersectsBox(this.tempBox),intersectsTriangle:p=>{p.a.applyMatrix4(e.matrixWorld),p.b.applyMatrix4(e.matrixWorld),p.c.applyMatrix4(e.matrixWorld);const d=this.tempVector,w=this.tempVector2;this.getColliderEnds(i,d,w);const l=new ee(d,w),h=new u,r=new u,f=p.closestPointToSegment(l,h,r);if(f<t){const A=t-f,c=r.sub(h).normalize();c.y<0&&(c.y=0,c.normalize()),i.position.addScaledVector(c,A*.5)}}})}}function ue(s,e,n){const i=new me(e);i.initBVH(),s.add(i.collider);const t={forward:!1,backward:!1,left:!1,right:!1};window.addEventListener("keydown",l=>{switch(l.code){case"KeyW":t.forward=!0;break;case"KeyS":t.backward=!0;break;case"KeyA":t.left=!0;break;case"KeyD":t.right=!0;break}}),window.addEventListener("keyup",l=>{switch(l.code){case"KeyW":t.forward=!1;break;case"KeyS":t.backward=!1;break;case"KeyA":t.left=!1;break;case"KeyD":t.right=!1;break}});const o=new te(0,0,0,"YXZ"),a=Math.PI/2,p=.002;document.body.addEventListener("click",()=>{document.body.requestPointerLock()}),document.body.addEventListener("mousemove",l=>{document.pointerLockElement===document.body&&(o.setFromQuaternion(n.quaternion),o.y-=l.movementX*p,o.x-=l.movementY*p,o.x=Math.max(-a,Math.min(a,o.x)),n.quaternion.setFromEuler(o))});const d=new u,w=new u(0,1,0);return l=>{d.set(0,0,0),t.forward&&(d.z-=1),t.backward&&(d.z+=1),t.left&&(d.x-=1),t.right&&(d.x+=1),d.normalize();const h=new u;n.getWorldDirection(h),h.y=0,h.normalize();const r=new u;r.crossVectors(h,w).normalize();const f=new u;return f.addScaledVector(h,-d.z),f.addScaledVector(r,d.x),i.update(l,f),n.position.lerp(new u().copy(i.collider.position).add(new u(0,1.25,0)),.5),i.collider.position}}function fe(s){const e=s.domElement,n=e.clientWidth,i=e.clientHeight,t=e.width!==n||e.height!==i;return t&&s.setSize(n,i,!1),t}class ge{instance;#t;#e;#i;constructor(e){this.#t=e,this.instance=new ie(75,e.clientWidth/e.clientHeight,.1,1e3),this.instance.position.set(2,2.5,5.25),this.#e=new ne(this.instance,e),this.#e.enableDamping=!0;const n=C();this.#i=n.addFolder("Camera"),this.#i}tick(e){fe(e)&&(this.instance.aspect=this.#t.clientWidth/this.#t.clientHeight,this.instance.updateProjectionMatrix()),this.#e.enabled&&this.#e.update()}setControlsEnabled(e){this.#e.enabled=e}}const z=document.createElement("canvas");document.body.appendChild(z);const y=new oe({canvas:z,antialias:!0,alpha:!0});y.setPixelRatio(Math.min(window.devicePixelRatio,2));y.shadowMap.enabled=!0;y.shadowMap.type=se;const x=k(),we=new re(console.log,(s,e,n)=>console.log(`Loading ${e} / ${n}`),console.error),ye=new ae(we),F=pe();let P;const be=new de;ye.load(`${location.href}/scene.gltf`,s=>{x.add(s.scene),s.scene.traverse(e=>{e.name==="Object_13"&&(console.log(e),e.castShadow=!0,e.receiveShadow=!0)});try{P=ue(x,s.scene,b.instance),b.setControlsEnabled(!1)}catch(e){console.warn("Failed to setup Antigravity navigation:",e)}});const b=new ge(z);x.add(b.instance);he();const M=new ce;document.body.appendChild(M.dom);function B(){requestAnimationFrame(B),M.begin();const s=be.getDelta();P&&P(s),F&&F(s),b.tick(y),y.render(x,b.instance),M.end()}B();
